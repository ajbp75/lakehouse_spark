Perfeito. Abaixo estÃ¡ um **resumo de defesa enxuto, estudÃ¡vel e direto**, exatamente no nÃ­vel que costuma cair em **conversa tÃ©cnica de 5â€“8 minutos**.
Se vocÃª souber responder **isso aqui**, vocÃª passa tranquilo.

---

# ğŸ§  Defesa TÃ©cnica â€” Teste Sonar (Guia de Estudo)

## 1ï¸âƒ£ VisÃ£o geral da soluÃ§Ã£o (30â€“40s)

**Pergunta tÃ­pica:** *â€œExplica rapidamente o que vocÃª construiu.â€*

> Implementei um mini Lakehouse com camadas Bronze, Silver e Gold a partir de CSVs com problemas propositais.
> Na Bronze fiz ingestÃ£o bruta, na Silver tratei qualidade, deduplicaÃ§Ã£o e tipagem, e na Gold modelei um Star Schema mÃ­nimo com uma dimensÃ£o de cliente, duas tabelas fato e uma dimensÃ£o de data opcional.
> Entreguei tambÃ©m checks de Data Quality, log de execuÃ§Ã£o e mÃ©tricas SQL.

---

## 2ï¸âƒ£ Bronze â†’ Silver â†’ Gold (conceito)

**Pergunta:** *â€œO que muda de uma camada para outra?â€*

* **Bronze**: dados como vieram, sem regra de negÃ³cio
* **Silver**: limpeza, deduplicaÃ§Ã£o, tratamento de nulos e chaves
* **Gold**: dados prontos para consumo analÃ­tico (modelagem dimensional)

ğŸ‘‰ A Gold Ã© **idempotente**: rodar 2x nÃ£o duplica dados.

---

## 3ï¸âƒ£ DeduplicaÃ§Ã£o (ponto-chave)

**Pergunta:** *â€œComo vocÃª tratou duplicidades?â€*

Usei `row_number()` com `Window.partitionBy().orderBy(desc)`:

* `customers`: `customer_id`, mantendo o maior `created_at`
* `work_orders`: `work_order_id`, mantendo o maior `updated_at`
* `parts_sales`: `sale_id`, mantendo o maior `updated_at`

ğŸ‘‰ CritÃ©rio temporal explÃ­cito e documentado.

---

## 4ï¸âƒ£ Tratamento de nulos

**Pergunta:** *â€œComo lidou com campos crÃ­ticos nulos?â€*

* `fact_work_order.order_date`: registros descartados (campo essencial)
* `fact_parts_sales.unit_price`: substituÃ­do por 0
* Recalculei `total_price` apÃ³s tipagem numÃ©rica para evitar erro de precisÃ£o

ğŸ‘‰ DecisÃµes pragmÃ¡ticas, alinhadas ao domÃ­nio.

---

## 5ï¸âƒ£ Tratamento de Ã³rfÃ£os

**Pergunta:** *â€œE chaves quebradas?â€*

* `fact_work_order.customer_id` inexistente â†’ mapeado para `UNKNOWN (-1)`
* `fact_parts_sales` sem `work_order_id` vÃ¡lido â†’ removido via `inner join`

ğŸ‘‰ Mantive integridade referencial na Gold.

---

## 6ï¸âƒ£ Data Quality (DQ)

**Pergunta:** *â€œQue tipo de qualidade vocÃª validou?â€*

Implementei trÃªs checks mÃ­nimos:

1. Taxa de nulos em colunas crÃ­ticas
2. Taxa de duplicidade por chave
3. Taxa de Ã³rfÃ£os entre fatos e dimensÃµes

Cada check gera:

* valor da mÃ©trica
* threshold
* status PASS/FAIL
* descriÃ§Ã£o curta

Resultados em `dq_results.csv`.

---

## 7ï¸âƒ£ Log de execuÃ§Ã£o

**Pergunta:** *â€œComo vocÃª sabe que a pipeline rodou corretamente?â€*

Gerei `pipeline_runs.csv` com:

* `run_id`
* timestamps de inÃ­cio e fim
* duraÃ§Ã£o
* nÃºmero de linhas geradas em cada tabela Gold

ğŸ‘‰ Isso permite auditoria simples e rastreabilidade.

---

## 8ï¸âƒ£ DimensÃ£o de data (bÃ´nus)

**Pergunta:** *â€œPor que criar uma dim_date?â€*

Criei uma `dim_date` opcional:

* derivada exclusivamente das datas presentes nos fatos
* com chave `YYYYMMDD`
* atributos Ãºteis para BI (mÃªs, ano, dia da semana, fim de semana)

ğŸ‘‰ Evitei calendÃ¡rio artificial fora do domÃ­nio real dos dados.

---

## 9ï¸âƒ£ SQL / MÃ©tricas

**Pergunta:** *â€œQue tipo de anÃ¡lise dÃ¡ para fazer?â€*

Implementei 3 mÃ©tricas:

1. Receita de peÃ§as por cliente (Ãºltimos 90 dias)
2. Ordens por status por mÃªs
3. Ticket mÃ©dio de peÃ§as por ordem

Todas baseadas nas tabelas Gold.

---

## ğŸ”Ÿ Por que nÃ£o usei Fabric diretamente?

(se perguntarem â€” resposta madura)

> NÃ£o tive permissÃ£o ativa para criar Lakehouse no Fabric, entÃ£o implementei a lÃ³gica em PySpark local, mantendo conceitos equivalentes de Lakehouse.
> A soluÃ§Ã£o Ã© portÃ¡vel para Fabric ou Databricks sem mudanÃ§a conceitual.

---

## ğŸ§© Pergunta final clÃ¡ssica

**â€œO que vocÃª melhoraria com mais tempo?â€**

Resposta perfeita:

* Automatizar execuÃ§Ã£o (orquestraÃ§Ã£o)
* Versionar DQ thresholds
* Criar testes automatizados
* Expandir dimensÃ£o de data (feriados, fiscal)

ğŸ‘‰ Mostra visÃ£o de evoluÃ§Ã£o, sem arrependimento.

---

## ğŸ Dica final (importante)

NÃ£o decore frases.
**Entenda a lÃ³gica**, porque:

* suas decisÃµes foram corretas
* todas sÃ£o defensÃ¡veis
* nÃ£o hÃ¡ gambiarra

Se quiser, no prÃ³ximo passo posso:

* simular **a defesa em formato de entrevista** (perguntas e respostas rÃ¡pidas), ou
* condensar isso num **one-pager de estudo** para revisar em 5 minutos.

